actor S7_DaggerMelee  : boolean { } // Credits: Sprites: Apocalyptic Studio, Captain J, Alex_Mercer
actor S7_Dagger2Melee : boolean { } // Credits: Sprites: Apocalyptic Studio, Captain J, Alex_Mercer
actor S7_KickMelee    : boolean { } // Credits: Sprites: ???, Alex_Mercer

actor S7_QuickMelee : S7_BaseWeapon {
    tag " "
    
    states {
    Ready:
        TNT1 A 0 A_JumpIfInventory ("S7_DaggerMelee", 1, "DaggerMelee")
        TNT1 A 0 A_JumpIfInventory ("S7_Dagger2Melee", 1, "Dagger2Melee")
        TNT1 A 0 A_JumpIfInventory ("S7_KickMelee", 1, "KickMelee")
        TNT1 A 0 A_Jump (256, "KickMelee")
        wait
    
    /*Select:
        TNT1 A 0 A_Raise
        wait
    Deselect:
        TNT1 A 0 A_Lower
        wait*/
    Fire:
        goto Ready
    
    DaggerMelee:
        DAG1 AB 1
    DaggerMelee.Mid:
        TNT1 A 0 A_JumpIfInventory ("PowerStrength", 1, "DaggerMelee.Berserk")
        TNT1 A 0 A_CustomPunch (random [weaponDamage] (1, 5) * 10, 1, 0, "S7_MeleePuff")
        goto DaggerMelee.End
    DaggerMelee.Berserk:
        TNT1 A 0 A_CustomPunch (3 * random [weaponDamage] (1, 5) * 10, 1, 0, "S7_MeleePuff")
        goto DaggerMelee.End
    DaggerMelee.End:
        DAG1 CDE 1
        goto MeleeDone
    
    Dagger2Melee:
        goto MeleeDone
    
    KickMelee:
        KICK BCD 1
    KickMelee.Mid:
        TNT1 A 0 A_JumpIfInventory ("PowerStrength", 1, "KickMelee.Berserk")
        TNT1 A 0 A_CustomPunch (random [weaponDamage] (1, 5) * 13, 1, 0, "S7_MeleePuff")
        goto KickMelee.End
    KickMelee.Berserk:
        TNT1 A 0 A_CustomPunch (3 * random [weaponDamage] (1, 5) * 13, 1, 0, "S7_MeleePuffStrong")
        goto KickMelee.End
    KickMelee.End:
        KICK H 4
        KICK IGFEDCBA 1
        goto MeleeDone
    
    MeleeDone:
        TNT1 A 1 ACS_NamedExecuteAlways ("S7_QuickMelee")
        TNT1 A 1 A_WeaponReady (WRF_NoBob | WRF_NoFire)
        wait
    }
}